/*
Validata 1.8, a jQuery plug-in
written by: Vittorio Vittori
dev web site: http://vittoriovittori.com
date: 2012-07-10
compatible with jQuery 1.4.4 or later
*/
(function(a){return a.fn.validata=function(b){var c=function(b){g.callback.removeMessage(b);b.object.addClass(b.message.class);if(b.message.show){if(!b.message.where){b.object.after(b.message.html)}else{a(b.message.where).append(b.message.html)}}};var d=function(b){i(b.element);if(!b.message.where&&b.object.next().hasClass(b.message.class)){b.object.next().remove()}else{a(b.message.where).empty()}};var e=function(a){var b=a.response;var c="";var d="";var e="";var f="";if(b===false){c=a.element.post.is_false[0];if(a.element.post.is_false[1]){d=a.element.post.is_false[1]}else if(a.element.success_class){d=a.element.success_class}else{d=g.message.success_class}}else if(b===true){c=a.element.post.is_true[0];if(a.element.post.is_true[1]){d=a.element.post.is_true[1]}else if(a.element.error_class){d=a.element.error_class}else{d=g.message.error_class}}else if(!a.element.post.error_skip){c=a.element.post.error_message+a.element.post.data;if(a.element.post.is_true[1]){d=a.element.post.is_true[1]}else if(a.element.error_class){d=a.element.error_class}else{d=g.message.error_class}}else{c=a.element.post.is_true[0];if(a.element.post.is_true[1]){d=a.element.post.is_true[1]}else if(a.element.error_class){d=a.element.error_class}else{d=g.message.error_class}}if(a.element.post.where){e=a.element.post.where}else if(a.element.where){e=a.element.where}else{e=g.message.where}if(a.element.post.element){f=a.element.post.element}else if(a.element.element){f=a.element.element}else{f=g.message.element}g.callback.addPostMessage({object:a.object,element:a.element,message:{where:e,"class":d,html:"<"+f+' class="'+d+'">'+c+"</"+f+">"}})};var f={message:{element:"div",error_class:"error",success_class:"success",where:false,all:true,show:true,stop_query:true},post:{reverse:false,error_skip:true,error_message:"Unexpected data from the remote page, to validate it as true set <strong>post:{ error_skip:true }</strong>, the data is: ",looking:false,last_post:"",element:false,where:false},callback:{addMessage:c,removeMessage:d,onSendingData:false,addPostMessage:c,removePostMessage:d,onSuccess:false,onError:false},regex:{name:/^[A-Za-z' ]{3,100}$/,username:/^[A-Za-z0-9_]{3,100}$/,number:/^\s*\d+\s*$/,url:/^(http[s]?:\/\/){0,1}(www\.){0,1}[a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,5}[\.]{0,1}/,email:/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i,credit_card:/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,cc_visa:/^4[0-9]{12}(?:[0-9]{3})?$/,cc_master_card:/^5[1-5][0-9]{14}$/,cc_american_express:/^3[47][0-9]{13}$/,cc_diners_club:/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/,cc_discover:/^6(?:011|5[0-9]{2})[0-9]{12}$/,cc_jcb:/^(?:2131|1800|35\d{3})\d{11}$/,ip:/^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$/}};var g=a.extend(true,f,b);var h=function(a,b,c){var d;a.element==null||a.element==undefined?d=g.message.element:d=a.element;var e;a.error_class==null?e=g.message.error_class:e=a.error_class;var f;!a.where?f=g.message.where:f=a.where;if(b!=null){if(c!=null)b=b.replace("%%",c);return{element:d,show:a.show,where:f,"class":e,text:b,html:"<"+d+' class="'+e+'">'+b+"</"+d+">"}}else{return{element:d,show:a.show,where:f,text:b,"class":e}}};var i=function(a){j(a.selector,a);j(a.where+"*",a)};var j=function(b,c){if(c.error_class!=undefined)a(b).removeClass(c.error_class);if(c.success_class!=undefined)a(b).removeClass(c.success_class);if(g.message.error_class!=undefined)a(b).removeClass(g.message.error_class);if(g.message.success_class!=undefined)a(b).removeClass(g.message.success_class);if(c.post!=null){if(c.post.is_true.length>1)a(b).removeClass(c.post.is_true[1]);if(c.post.is_false.length>1)a(b).removeClass(c.post.is_false[1])}};var k=function(b){a(b.selector).blur(function(){if(b.post!=null){if(n(b)){if(!b.post.looking){b.post.looking=true;if(a(b.selector).val()!=b.post.last_post){b.post.last_post=a(b.selector).val();l(b)}}}}else{n(b)}})};var l=function(b){var c={};c[b.post.param_name]=a(b.selector).val();if(g.callback.onSendingData){g.callback.onSendingData({object:a(b.selector),element:b})}a.post(b.post.url,c,function(c){b.post.data=c;b.post.looking=false;e({object:a(b.selector),element:b,response:m(c)})})};var m=function(a){if(a==""||a=="0"||a=="false"){return false}else if(a=="1"||a=="true"){return true}else{return a}};var n=function(b){var c=b.selector;if(a(c).attr("value")=="")a(c).attr("value",b.value);if(b.required!=null&&a(c).val()==""||b.required!=null&&a(c).val()==b.value&&!b.default_is_valid){g.callback.addMessage({object:a(c),element:b,message:h(b,b.required)});return false}if(b.name!=null&&!o(c,b,g.regex.name,b.name))return false;if(b.username!=null&&!o(c,b,g.regex.username,b.username))return false;if(b.number!=null&&!o(c,b,g.regex.number,b.number))return false;if(b.url!=null&&!o(c,b,g.regex.url,b.url))return false;if(b.email!=null&&!o(c,b,g.regex.email,b.email))return false;if(b.credit_card!=null&&!o(c,b,g.regex.credit_card,b.credit_card))return false;if(b.cc_visa!=null&&!o(c,b,g.regex.cc_visa,b.cc_visa))return false;if(b.cc_master_card!=null&&!o(c,b,g.regex.cc_master_card,b.cc_master_card))return false;if(b.cc_american_express!=null&&!o(c,b,g.regex.cc_american_express,b.cc_american_express))return false;if(b.cc_diners_club!=null&&!o(c,b,g.regex.cc_diners_club,b.cc_diners_club))return false;if(b.cc_discover!=null&&!o(c,b,g.regex.cc_discover,b.cc_discover))return false;if(b.cc_jcb!=null&&!o(c,b,g.regex.cc_jcb,b.cc_jcb))return false;if(b.ip!=null&&!o(c,b,g.regex.ip,b.ip))return false;if(b.compare!=null){if(!x({object:a(c),element:b,property:"compare",length:2}))return false;if(a(c).val()!=a(b.compare[0]).val()){g.callback.addMessage({object:a(c),element:b,message:h(b,b.compare[1])});return false}}if(b.min_length!=null){if(!x({object:a(c),element:b,property:"min_length",length:2}))return false;if(a(c).val().length<b.min_length[0]){g.callback.addMessage({object:a(c),element:b,message:h(b,b.min_length[1],b.min_length[0])});return false}}if(b.max_length!=null){if(!x({object:a(c),element:b,property:"max_length",length:2}))return false;if(a(c).val().length>b.max_length[0]){g.callback.addMessage({object:a(c),element:b,message:h(b,b.max_length[1],b.max_length[0])});return false}}if(b.regex!=null){if(!x({object:a(c),element:b,property:"regex",length:2}))return false;if(!a(c).val().match(b.regex[0])){g.callback.addMessage({object:a(c),element:b,message:h(b,b.regex[1])});return false}}if(b.post!=null){if(a(b.selector).val()!=b.post.last_post){}else{if(!x({object:a(c),element:b,target:b.post,property:"is_false",length:2}))return false;if(!x({object:a(c),element:b,target:b.post,property:"is_true",length:2}))return false;if(b.post.looking===false){if(b.post.reverse){if(m(b.post.data)===false){g.callback.addMessage({object:a(c),element:b,message:h(b,b.post.is_false[0])});return false}}else{if(m(b.post.data)===true){g.callback.addMessage({object:a(c),element:b,message:h(b,b.post.is_true[0])});return false}}}}}return true};var o=function(b,c,d,e){if(!a(b).val().match(d)){g.callback.addMessage({object:a(b),element:c,message:h(c,e)});return false}else if(a(b).val()==c.value&&!c.default_is_valid){g.callback.addMessage({object:a(b),element:c,message:h(c,e)});return false}else{return true}};var p=function(b){a(b.selector).change(function(){q(b)})};var q=function(b){var c=b.selector;if(b.required!=null&&!a(c).is(":checked")){g.callback.addMessage({object:a(c),element:b,message:h(b,b.required)});return false}else{g.callback.removeMessage({object:a(c),element:b,message:h(b)})}return true};var r=function(b){a(b.selector).change(function(){var a=b;s(a)})};var s=function(b){var c=b.selector;var d=a(c).is(":checked");if(b.required!=null&&!d){g.callback.addMessage({object:a(c),element:b,message:h(b,b.required)});return false}else if(b.requires!=null&&a(c+":checked").attr("value")!=b.requires[0].toString()){g.callback.addMessage({object:a(c),element:b,message:h(b,b.requires[1])});return false}else{g.callback.removeMessage({object:a(c),element:b,message:h(b)});return true}};var t=function(b){a(b.selector).change(function(){u(b)})};var u=function(b){var c=b.selector;if(b.required!=null&&!a(c+" option:selected").index(0)){g.callback.addMessage({object:a(c),element:b,message:h(b,b.required)});return false}else if(b.requires!=null&&a(c+" option:selected").attr("value")!=b.requires[0].toString()){g.callback.addMessage({object:a(c),element:b,message:h(b,b.requires[1])});return false}else{g.callback.removeMessage({object:a(c),element:b,message:h(b)})}return true};var v=function(b){a(b.selector).change(function(){w(b)})};var w=function(b){var c=b.selector;if(b.required!=null&&a(c).attr("value")==""){g.callback.addMessage({object:a(c),element:b,message:h(b,b.required)});return false}else if(b.requires!=null){var d=a(c).attr("value").split(".");var e=false;for(var f=0;f<b.requires[0].length;f++){b.requires[0][f]=b.requires[0][f].replace(".","");if(b.requires[0][f].toLowerCase()==d[d.length-1].toLowerCase())e=true}if(!e){g.callback.addMessage({object:a(c),element:b,message:h(b,b.requires[1])});return false}else{g.callback.removeMessage({object:a(c),element:b,message:h(b)})}}else{g.callback.removeMessage({object:a(c),element:b,message:h(b)})}return true};var x=function(a){var b;if(a.target!=null)b=a.target;else b=a.element;var c=b[a.property]instanceof Array;if(!c){g.callback.addMessage({object:a.object,element:a.element,message:h(a.element,'jQuery plugin warning: property "'+a.property+'" must be an Array')})}else if(b[a.property].length!=a.length){g.callback.addMessage({object:a.object,element:a.element,message:h(a.element,'jQuery plugin warning: property "'+a.property+'" must be an Array with '+a.length+" parameters")})}return c};var y=function(b){a(b.selector).focus(function(){if(a(this).attr("value")==b.value&&!b.keep_value)a(this).attr("value","");g.callback.removeMessage({object:a(this),element:b,message:h(b)})})};var z=function(){for(var a=0;a<g.elements.length;a++){if(g.elements[a].default_to_empty){A(a)}}};var A=function(b){var c=a(g.elements[b].selector);var d=g.elements[b].selector;if(c.attr("type")=="checkbox"){c.attr("value","")}else if(c.attr("type")=="radio"){c.attr("value","")}else if(c.attr("type")=="file"){c.attr("value","")}else if(c[0]!=undefined&&c[0].tagName.toLowerCase()=="select"){a(d+" option:selected").attr("value","")}else if(c.attr("type")=="text"||c.attr("type")=="password"||c[0]!=undefined&&c[0].tagName.toLowerCase()=="textarea"){c.attr("value","")}};var B=function(){var b=true;var c;for(var d=0;d<g.elements.length;d++){c=g.elements[d];if(a(c.selector).attr("type")=="radio"){if(!s(c)){if(!g.message.all)return false;else b=false}}else if(a(c.selector).attr("type")=="checkbox"){if(!q(c)){if(!g.message.all)return false;else b=false}}else if(a(c.selector).attr("type")=="file"){if(!w(c)){if(!g.message.all)return false;else b=false}}else if(a(c.selector).attr("type")=="text"){if(!n(c)){if(!g.message.all)return false;else b=false}}else if(a(c.selector).attr("type")=="password"){if(!n(c)){if(!g.message.all)return false;else b=false}}else if(a(c.selector)[0]!=undefined&&a(c.selector)[0].tagName.toLowerCase()=="textarea"){if(!n(c)){if(!g.message.all)return false;else b=false}}else if(a(c.selector)[0]!=undefined&&a(c.selector)[0].tagName.toLowerCase()=="select"){if(!u(c)){if(!g.message.all)return false;else b=false}}}if(b){z()}return b};var C=function(b){a(window).click(function(c){if(a(c.target).is(b.selector)&&!B()){c.preventDefault();if(typeof b.submit==="string"||typeof b.submit==="object")a(b.selector).val(b.submit);b.error_class!=null?a(b.selector).addClass(b.error_class):a(b.selector).addClass(g.message.error_class);if(g.callback.onError)g.callback.onError(b,c);return false}else if(a(c.target).is(b.selector)){a(b.selector).attr("value",b.value);b.error_class!=null?a(b.selector).removeClass(b.error_class):a(b.selector).removeClass(g.message.error_class);if(g.callback.onSuccess)g.callback.onSuccess(b,c)}})};var D=function(b){a(b.selector).click(function(){if(b.keep_value!=null&&!b.keep_value){a(this).attr("value","")}});a(b.selector).bind("keypress",function(c){if(c.keyCode==13&&!B()){return false}else if(c.keyCode==8&&b.keep_value!=null&&!b.keep_value){a(b.selector).attr("value","")}})};for(var E=0;E<g.elements.length;E++){if(g.elements[E].default_to_empty==null){g.elements[E].default_to_empty=false}if(g.elements[E].default_is_valid==null){g.elements[E].default_is_valid=false}if(a(g.elements[E].selector).attr("value")!=""){g.elements[E].value=a(g.elements[E].selector).attr("value")}if(g.elements[E].show==null||g.elements[E].show==undefined){g.elements[E].show=g.message.show}if(a(g.elements[E].selector).attr("type")=="checkbox"){p(g.elements[E])}else if(a(g.elements[E].selector).attr("type")=="radio"){r(g.elements[E])}else if(a(g.elements[E].selector).attr("type")=="file"){v(g.elements[E])}else if(a(g.elements[E].selector)[0]!=undefined&&a(g.elements[E].selector)[0].tagName.toLowerCase()=="select"){t(g.elements[E])}else if(a(g.elements[E].selector).attr("type")=="text"||a(g.elements[E].selector).attr("type")=="password"||a(g.elements[E].selector)[0]!=undefined&&a(g.elements[E].selector)[0].tagName.toLowerCase()=="textarea"){y(g.elements[E]);k(g.elements[E])}else if(g.elements[E].submit!=null){C(g.elements[E])}if(g.message.stop_query){D(g.elements[E])}}}})(jQuery)